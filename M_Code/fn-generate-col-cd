// Purpose: Create a code column by removing spaces and non-alphabetic characters from a text column, converting to uppercase.

let
    fnGenerateColCd = (col as text) as text =>
        let
            // Handle null or empty inputs safely
            safeText = if col <> null then col else "",

            // Keep only A–Z and a–z
            lettersOnly = Text.Select(safeText, {"A".."Z", "a".."z"}),

            // Convert to uppercase
            colCd = Text.Upper(lettersOnly)
        in
            colCd
in
    fnGenerateColCd
